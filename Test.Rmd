---
title: "FirstRun"
author: "Lezheng Fang"
date: "2/13/2022"
output:
  pdf_document: default
  html_document: default
---


## Read Climate and Cherry Blossom Data
```{r DataReading}
library(Amelia)

climate_name = "cleaned_with_NA_kyoto.csv"
blossom_name = "kyoto.csv"

climate <- read.csv(climate_name)
blossom <- read.csv(blossom_name)
summary(blossom)
str(blossom)
summary(climate)
str(climate)
missmap(climate)
```

## Impute Missing data in climate
```{r MissingData-Mean}
    set.seed(1)    
    m = 5
    climate$doy = as.Date(climate$DATE)
    str(climate$doy)
    climate_amelia <- amelia(x = climate,idvars = c("NAME","MONTH","DAY","YEAR","DATE","year"),ts ="doy",m=m)
    str(climate_amelia$imputations$imp1)
  
    climate_imputed <- climate
  # Average the imputations between different simulated datasets
    col_index = which(names(climate_amelia$imputations$imp1) %in% c("average_temperature", "max_temperature","min_temperature","Rain_cm"))
    for( col in col_index){
      temp2=numeric() 
      for (i in 1:m){
        temp2 = cbind(temp2, climate_amelia$imputations[[i]][,col]) 
        }
      climate_imputed[,col] = apply(temp2, 1, mean) 
    }
  missmap(climate_imputed)
  head(climate_imputed)
  # Saving imputed Data
  #saveRDS(climate_imputed,file = "climate_imputed.csv")
  col = names(cliamte_imputed)
  write.table(climate_imputed,'kyoto_climate_imputed.csv',sep = ',',col.names = names(climate_imputed),row.names =row.names(climate_imputed))
  #readRDS()
  
```

```{r Model}

```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:
